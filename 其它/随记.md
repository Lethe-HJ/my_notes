
## linux


`ps -ef |grep java`

a：显示现行终端机下的所有进程，包括其他用户的进程；
u：显示进程拥有者、状态、资源占用等的详细信息（注意有“-”和无“-”的区别）；
x：显示没有控制终端的进程。通常与 a 这个参数一起使用，可列出较完整信息；
-e：显示所有进程；
-f：完整输出显示进程之间的父子关系；
-l：较长、较详细的将该 PID 的的信息列出；

检查kolla-ansible进程是否存在：
字段含义如下：
UID       PID       PPID      C     STIME    TTY       TIME         CMD
zzw      14124   13991      0     00:38      pts/0      00:00:00    grep --color=auto dae

UID      ：程序被该 UID 所拥有
PID      ：就是这个程序的 ID 
PPID    ：则是其上级父程序的ID
C          ：CPU使用的资源百分比
STIME ：系统启动时间
TTY     ：登入者的终端机位置
TIME   ：使用掉的CPU时间。
CMD   ：所下达的是什么指令

`ps -aux`
USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root          1  0.0  0.1  19356   968 ?        Ss   08:29   0:00 /sbin/init

同时输出到屏幕和文件
`echo log | tee new_logs`
错误输出与标准输出输出到同一个文件
`command  2>&1 | tee -a log`


`tar -xvf 包名.tar`
`tar -zxvf 包名.tar.gz`
`unzip 包名.zip`

查看已挂载得硬件设备信息
`df -h`

编译
`./configure`

`make`

`make install`

打印转义字符
`echo -e "\n"`

不挂断地运行命令
`nohup /bin/bash ./test.sh`
输出会自动追加到nohup.out

指定输出文件,并同时输出标准和错误输出,后台运行
nohup command > myout.file 2>&1 &


用 & 在程序结尾来让程序自动运行
`/usr/local/mysql/bin/mysqld_safe –user=mysql &`

rpm -ivh XXX.rpm
dpkg -i XXXX.deb

chmod -R 777 文件夹
参数-R是递归的意思
777表示开放所有权限
chmod 777 test.sh
chmod +x 某文件
如果给所有人添加可执行权限：chmod a+x 文件名；
如果给文件所有者添加可执行权限：chmod u+x 文件名；
如果给所在组添加可执行权限：chmod g+x 文件名；
如果给所在组以外的人添加可执行权限：chmod o+x 文件名；


### ubuntu
修改dns
sudo vi /etc/systemd/resolved.conf

添加默认路由
route add default gw 192.168.0.1

### vim操作

0 移动到行首
$ 移动到行尾
^ 移动到行首第一个非空白字符上
gg 跳转到第1行
G 跳转到最后一行
10G 跳转到第10行
/str 查找字符串str 
    n下一个 N上一个
% 移动到匹配的括号上
dd 删除当前行
yy 复制当前行到缓冲区
nyy 复制光标所在行的以下几行
P 粘贴当前缓冲区的内容
u 撤销上次的操作
s/要替换的内容/替换成的内容/   光标所在行的的第一个
s/要替换的内容/替换成的内容/g   光标所在行全部替换
%s/要替换的内容/替换成的内容/g  文件内容所有的都替换
gg=G 对齐


## kylincloud

本地存储需要打开lvm


`cd /kylincloud`

清空环境

`kolla-ansible cleanup -i multinode`

`kolla-ansible post-deploy -i multinode`

`cp /etc/kolla/admin-openrc.sh /root/`

`source ~/admin-openrc.sh`

`nova service-list`

`neutron agent-list`

`cinder service-list`

查看某个服务的简单日志

`docker logs cinder_volume`

日志目录

`/var/lib/docker/volumes/kolla_logs/_data/`

实时查看日志

`tail -f /var/lib/docker/volumes/kolla_logs/_data/nova-api.log`

上传镜像

`glance image-create --name 镜像名 --disk-format raw --container-format bare --visibility public --progress --file 镜像文件名`

## docker 

运行镜像成容器 并设置守护进程
`docker run --name sponge_api --network sponge_network -p 8080:8080 -d sponge_api:latest /bin/bash -c "tail -f /dev/null"`
对于制作良好的镜像运行成容器
`docker run --name sponge_db --network sponge_network -p 3306:3306 -d mariadb:latest`

由容器生成镜像
`docker commit 容器名 生成的镜像名`

-p 3306:3306 指定端口映射
--network sponge_network 指定网络命名空间
-e --env=[] 指定环境变量
--add-host=sponge_dbop:172.18.0.1 指定hosts
-ip 指定ip地址

需指定-e 参数 否则会报错缺少环境变量
这个密码会被当作root远程登陆的密码
root | *B816D23BA0E3A022832B33C548BF6D8D8C19DBE3 | %
切记不要修改root本地登陆的密码 因为CMD默认不使用密码登陆,如果修改root本地登陆密码则会数据库服务重启失败

拷贝文件到docker容器
docker cp database-200414.sql sponge_db:/root/

制作镜像
在Dockerfile所在文件夹中
docker build -t sponge_api .

删除所有镜像dockers
docker rmi $(docker images -q) 

我的阿里云镜像仓库

1. 登录阿里云Docker Registry
   

`$ sudo docker login --username=15773663235 registry.cn-hangzhou.aliyuncs.com`

用于登录的用户名为阿里云账号全名，密码为开通服务时设置的密码。

您可以在访问凭证页面修改凭证密码。

1. 从Registry中拉取镜像
   

`$ sudo docker pull registry.cn-hangzhou.aliyuncs.com/sponge-hj/sponge_db:[镜像版本号]`

1. 将镜像推送到Registry

`$ sudo docker login --username=15773663235 registry.cn-hangzhou.aliyuncs.com`

`$ sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/sponge-hj/sponge_db:[镜像版本号]`

`$ sudo docker push registry.cn-hangzhou.aliyuncs.com/sponge-hj/sponge_db:[镜像版本号]`


### Dockerfile

ADD 遇到链接会自动下载 遇到压缩包会自动解压
COPY 


## mysql

mariadb 修改初始密码
`set password for root@localhost = password('hujin66.');`

`use mysql;`
`update user set password=password('123') where user='root' and host='localhost';`
`flush privileges;`


`create user "username"@"host" identified by "password";`
`grant all privileges on databasename.tablename to 'username'@'host' IDENTIFIED BY 'PASSWORD';`
`grant all privileges on *.* to root@'%' IDENTIFIED BY 'hujin666..';`允许远程连接所有数据表
`flush privileges;`

查看user权限
`select host,user,password,Grant_priv from mysql.user;`
不允许root远程登录
`delete from mysql.user where host="%" and user="root";`

导入sql文件
mysql -uroot -p < abc.sql

导出sql文件

导出表结构和数据
mysqldump -u用户名 -p密码 数据库名 > 数据库名.sql
只导出表结构
mysqldump -u用户名 -p密码 -d 数据库名 > 数据库名.sql

/usr/local/mysql/bin/  --->  mysql的data目录

## npm

换淘宝镜像

npm config set registry https://registry.npm.taobao.org --global

npm config set disturl https://npm.taobao.org/dist --global

或者临时指定
npm install --registry=https://registry.npm.taobao.org

清空所有包
npm uninstall *
清空缓存
npm cache clean --force

## git

git版本回退
`git reset --hard fae6966548e3ae76cfa7f38a461c438cf75ba965`
`git push -f -u origin master`


## shell

```shell
for j in `seq 0 3`
do
{
    echo -e "\n 在${ips[j]}执行 ${udp_command4[4*j+i]}\n"
}&
done
wait
# for循环}加& 可以启用多线程 wait可以等待前面的线程执行完毕
#${} 可以解析变量
```





warning  Delete `␍`  prettier/prettier

解决方案`npm run lint – --fix`



### promise.all



`**Promise.all(iterable)**` 方法返回一个 [`Promise`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise) 实例，此实例在 `iterable` 参数内所有的 `promise` 都“完成（resolved）”或参数中不包含 `promise` 时回调完成（resolve）；如果参数中 `promise` 有一个失败（rejected），此实例回调失败（reject），失败的原因是第一个失败 `promise` 的结果。

它通常在启动多个异步任务并发运行并为其结果创建承诺之后使用，以便人们可以等待所有任务完成。



```js
const promise1 = Promise.resolve(3);
const promise2 = 42;
const promise3 = new Promise((resolve, reject) => {
  setTimeout(resolve, 100, 'foo');
});

Promise.all([promise1, promise2, promise3]).then((values) => {
  console.log(values);
});
// expected output: Array [3, 42, "foo"]
```



