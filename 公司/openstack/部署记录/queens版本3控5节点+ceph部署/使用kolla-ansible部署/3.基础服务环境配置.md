
## 启用OpenStack存储库

在所有节点上安装

`$ yum install centos-release-openstack-queens`

`$ yum install python-openstackclient`

`$ yum install openstack-selinux`

## 安装mysql

在所有control节点中执行以下命令

`yum install mariadb mariadb-server python2-PyMySQL -y`

`$ vim /etc/my.cnf.d/openstack.cnf`

```
[mysqld]
# 这里的ip填当前机器或虚拟机的ip
bind-address = 10.10.16.55

default-storage-engine = innodb
innodb_file_per_table = on
max_connections = 4096
collation-server = utf8_general_ci
character-set-server = utf8
```

使能maradb的开机自启
`$ systemctl enable mariadb.service`

启动mariadb服务
`$ systemctl start mariadb.service`

初始化数据库账户
`$ mysql_secure_installation`

验证
`ps -ef | grep mariadb`
`systemctl status mariadb.service`

## 安装rabbitmq-server

在所有控制节点上执行以下命令

安装rabbitmq
`yum install rabbitmq-server -y`

启动消息队列服务，并将其配置为在系统引导时启动：
`systemctl start rabbitmq-server.service`
`systemctl enable rabbitmq-server.service`

添加openstack用户：
`rabbitmqctl add_user openstack RABBIT_PASS`
替换RABBIT_PASS为合适的密码。

允许用户配置，写入和读取访问权限 openstack：
`rabbitmqctl set_permissions openstack ".*" ".*" ".*"`

验证
`ps -ef | grep rabbitmq`
`systemctl status rabbitmq-server.service`

## 安装memcached

`yum install memcached python-memcached -y`

`vim /etc/sysconfig/memcached`

    OPTIONS="-l 127.0.0.1,::1,controller1"

`systemctl enable memcached.service`

`systemctl start memcached.service`

## Etcd

`yum install etcd -y`
`vim /etc/etcd/etcd.conf`

```
#[Member]
ETCD_DATA_DIR="/var/lib/etcd/default.etcd"
ETCD_LISTEN_PEER_URLS="http://10.10.16.55:2380"
ETCD_LISTEN_CLIENT_URLS="http://10.10.16.55:2379"
ETCD_NAME="controller1"
#[Clustering]
ETCD_INITIAL_ADVERTISE_PEER_URLS="http://10.10.16.55:2380"
ETCD_ADVERTISE_CLIENT_URLS="http://10.10.16.55:2379"
ETCD_INITIAL_CLUSTER="controller1=http://10.10.16.55:2380"
ETCD_INITIAL_CLUSTER_TOKEN="etcd-cluster-01"
ETCD_INITIAL_CLUSTER_STATE="new"
```

`systemctl enable etcd`
`systemctl start etcd`

